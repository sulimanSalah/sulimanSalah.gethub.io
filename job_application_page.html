<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>شغلني - تسجيل موظف جديد</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script type="module">
    // Firebase config
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";const firebaseConfig = {
  apiKey: "AIzaSyBRnKtJxWSA1Btdj1w8OP3LCMBfuP-iFCM",
  authDomain: "shaglni-c64c0.firebaseapp.com",
  projectId: "shaglni-c64c0",
  storageBucket: "shaglni-c64c0.appspot.com",
  messagingSenderId: "1093251098577",
  appId: "1:1093251098577:web:5fa52b85cbb604d8d3e769"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('employeeRegistrationForm');
  const nextBtn = document.getElementById('nextBtn');
  const sections = document.querySelectorAll('.form-section');
  let currentSection = 0;

  nextBtn.addEventListener('click', async () => {
    if (currentSection < sections.length - 1) {
      sections[currentSection].style.display = 'none';
      currentSection++;
      sections[currentSection].style.display = 'block';
      updateStepper();
    } else {
      nextBtn.disabled = true;
      nextBtn.innerText = 'جارٍ الحفظ...';

      const galleryFiles = document.getElementById('gallery').files;
      const galleryUrls = [];

      for (let i = 0; i < galleryFiles.length; i++) {
        const imageRef = ref(storage, `gallery/${Date.now()}_${galleryFiles[i].name}`);
        await uploadBytes(imageRef, galleryFiles[i]);
        const downloadURL = await getDownloadURL(imageRef);
        galleryUrls.push(downloadURL);
      }

      const data = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        jobTitle: document.getElementById('jobTitle').value,
        experience: document.getElementById('experience').value,
        skills: document.getElementById('skills').value,
        gallery: galleryUrls,
        timestamp: new Date()
      };

      try {
        await addDoc(collection(db, 'employees'), data);
        alert('تم تسجيل الموظف بنجاح!');
        form.reset();
        sections.forEach(section => section.style.display = 'none');
        sections[0].style.display = 'block';
        currentSection = 0;
        updateStepper();
      } catch (error) {
        console.error("فشل الإرسال:", error);
        alert("حدث خطأ أثناء إرسال البيانات.");
      }

      nextBtn.disabled = false;
      nextBtn.innerText = 'التالي';
    }
  });

  function updateStepper() {
    const steps = document.querySelectorAll('.step');
    steps.forEach((step, index) => {
      step.classList.remove('active');
      if (index === currentSection) step.classList.add('active');
    });
  }
});

  </script>
</head>
<body>
<!-- (نفس كود HTML الذي أرسلته أنت أعلاه، بنفس التنسيق الكامل، مع التأكد أن الـ id لكل input كما هو في سكربت JavaScript) -->
<!-- يفضل لصقه كاملاً داخل <body> هنا مع الاحتفاظ بالتنسيق -->
</body>
</html>